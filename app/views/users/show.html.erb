<% @title = "#{user_name(@user)} on Movi.im" %>
<% body_class 'user-show' %>
<article>

  <% if not @movies.empty? %>
    <header>
      <div class="main">
      <h1><% if my_page? %>
        Your movie stream
      <% else %>
        <%= @user.name %>
      <% end %>
      </h1>

      <p class="stats"><em><%= @user.watched.count %></em> movies &asymp; <%= life_wasted(@user) %> of life spent</p>
      <p class="stats"><%= positive(@user) %>, <%= hater(@user) %></p>
      </div>
    <nav>
      <ol>
        <li><% if my_page? %>
          <%= link_to "following", following_path %>
        <% elsif logged_in? %>
          <% if not current_user.following? @user %>
            <%= link_to 'follow person', follow_path(@user.id), :method => :post %>
          <% else %>
            <%= link_to 'unfollow', unfollow_path(@user.id), :method => :delete %>
          <% end %>
        <% end %></li>
        <li><%= link_to "#{@user.to_watch.count} to watch", to_watch_path(@user) %></li>
        <li><%= link_to "#{@user.watched.liked.count} liked", liked_path(@user) %></li>
      </ol>
    </nav>
    </header>

    <%= render 'movies/paginated', :movies => @movies %>

  <% elsif my_page? and @user.to_watch.size.zero? %>
    <section class="intro">
      <h1>Looks like you're new here.</h1>
      <p>
        <%= link_to 'Browse the site', root_path %> for movies, mark them as watched, or add them to your "to watch" list.
        As simple as that.
      </p>
      <% if (movies_count = @user.movies_from_friends.count) > 0 %>
        <p>
          Your friends have watched <%= pluralize(movies_count, 'movie') %>.
          See <%= link_to "people you're following", following_path %>
        </p>
      <% end %>
    </section>

  <% else %>
    <p><%= link_to "#{count @user.to_watch} to watch", to_watch_path(@user) %></p>
    <p><%= @user.name %> didn't tell us what he/she watched yet.</p>
  <% end %>

</article>
